import Parser from "tree-sitter";
import thalo from "@rejot-dev/tree-sitter-thalo";

//#region src/parser.ts
let parserInstance;
const getParser = () => {
	if (!parserInstance) {
		thalo.nodeTypeInfo ??= [];
		parserInstance = new Parser();
		parserInstance.setLanguage(thalo);
	}
	return parserInstance;
};
const parseThalo = (source) => {
	return getParser().parse(source);
};
const parser = {
	parse: (text, options) => {
		const tree = parseThalo(text);
		const rootNode = tree.rootNode;
		rootNode._thaloSource = text;
		rootNode._thaloFilepath = options?.filepath;
		rootNode._thaloHasErrors = tree.rootNode.hasError;
		return rootNode;
	},
	astFormat: "thalo-ast",
	locStart: (node) => node.startIndex,
	locEnd: (node) => node.endIndex
};

//#endregion
export { parser };
//# sourceMappingURL=parser.js.map